<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Hello World</title>
    </head>
    <body>
        <h1>Hello World</h1>
        {% for message in get_flashed_messages() %}
        <p style="color: red;">{{ message }}</p>
        {% endfor %}
        <p id="status"></p>
        <a id="download" href="/download">Download</a>
        <script type="text/javascript" src="{{
  url_for('static', filename='jquery-3.1.1.min.js') }}"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                console.log('js');
                $('#download').hide();
                var intervalId = setInterval(function() {
                    console.log('check');
                    $.ajax({
                        url: '/poll',
                        success: function(response) {
                            console.log('response:', response);
                            $('#status').text(response.status)
                            if(response.status === 'Complete') {
                                $('#download').show();
                                clearInterval(intervalId);
                            }
                        }
                    });
                }, 2000);
            });
        </script>
    </body>
</html>
